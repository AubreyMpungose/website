---
title: "Simple Linear Regression"
subtitle: "STA 210 - Spring 2022"
author: "Dr. Mine Ã‡etinkaya-Rundel"
footer:  "[sta210-s22.github.io/website](https://sta210-s22.github.io/website/)"
logo: "images/logo.png"
format: 
  revealjs: 
    theme: slides.scss
    transition: fade
    multiplex: true
editor: visual
---

```{r setup}
#| include: false
library(countdown)
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = 0.618,
  fig.align = "center",
  out.width = "80%"
)
```

## Topic

-   Use simple linear regression to describe the relationship between a quantitative predictor and quantitative response variable.
-   Estimate the slope and intercept of the regression line using the least squares method.
-   Interpret the slope and intercept of the regression line.

```{r packages}
#| include: false
library(tidyverse)
library(tidymodels)
library(knitr)
library(kableExtra)
library(fivethirtyeight) # fandango dataset
```

```{r data}
movie_scores <- fandango %>%
  rename(
    critics = rottentomatoes, 
    audience = rottentomatoes_user
    )
```

## Movie ratings data

The data set contains the "Tomatometer" score (`critics`) and audience score (`audience`) for 146 movies rated on Rotten Tomatoes.

```{r}
ggplot(movie_scores, 
       aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) + 
  labs(
    x = "Critics Score" , 
    y = "Audience Score"
    ) +
  theme_minimal()
```

## Movie ratings data

We want to fit a line to describe the relationship between the critics score and audience score.

```{r}
p <- ggplot(data = movie_scores, 
       mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) + 
  geom_smooth(method = "lm", color = "#F64740", se = FALSE) +
  labs(
    x = "Critics Score" , 
    y = "Audience Score"
    ) +
  theme_minimal()

p
```

## Terminology

::: columns
::: {.column width="30%"}
The **response, *Y***, is the variable describing the outcome of interest.

The **predictor, X**, is the variable we use to help understand the variability in the response.
:::

::: {.column width="70%"}
```{r}
#| out.width: "100%"
p
```
:::
:::

## Regression model

A **regression model** is a function that describes the relationship between the response, $Y$, and the predictor, $X$.

$$\begin{aligned} Y &= \color{black}{\textbf{Model}} + \text{Error} \\[8pt]
&= \color{black}{\mathbf{f(X)}} + \epsilon \\[8pt]
&= \color{black}{\boldsymbol{\mu_{Y|X}}} + \epsilon \end{aligned}$$

## Regression model {#regression-model-1}

::: columns
::: {.column width="50%"}
$$\begin{aligned} Y &= \color{purple}{\textbf{Model}} + \text{Error} \\[8pt]
&= \color{purple}{\mathbf{f(X)}} + \epsilon \\[8pt]
&= \color{purple}{\boldsymbol{\mu_{Y|X}}} + \epsilon \end{aligned}$$
:::

::: {.column width="50%"}
```{r}
m <- lm(audience ~ critics, data = movie_scores)

ggplot(data = movie_scores, 
       mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) + 
  geom_smooth(method = "lm", color = "purple", se = FALSE) +
  labs(x = "X", y = "Y") +
  theme_minimal() +
  theme(
    axis.text = element_blank(),
    axis.ticks.x = element_blank(), 
    axis.ticks.y = element_blank()
    )
```
:::
:::

## Regression model + residuals

::: columns
::: {.column width="50%"}
$$\begin{aligned} Y &= \color{purple}{\textbf{Model}} + \color{blue}{\textbf{Error}} \\[5pt]
&= \color{purple}{\mathbf{f(X)}} + \color{blue}{\boldsymbol{\epsilon}} \\[5pt]
&= \color{purple}{\boldsymbol{\mu_{Y|X}}} + \color{blue}{\boldsymbol{\epsilon}} \\[5pt]
 \end{aligned}$$
:::

::: {.column width="50%"}
```{r}
#| echo: false
ggplot(data = movie_scores,
       mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "purple", se = FALSE) +
  geom_segment(aes(x = critics, xend = critics, 
                   y = audience, yend = predict(m)), 
               color = "blue") +
  labs(x = "X", y = "Y") +
  theme_minimal() +
  theme(
    axis.text = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank()
  )
```
:::
:::

## Simple linear regression

When we have a quantitative response, $Y$, and a single quantitative predictor, $X$, we can use a [Simple linear regression] model to describe the relationship between $Y$ and $X$.
$$\begin{aligned} Y &= \mathbf{\beta_0 + \beta_1 X} + \epsilon \end{aligned}$$

$$\boldsymbol{\beta}_1: \text{Slope} \hspace{20mm} \boldsymbol{\beta}_0: \text{Intercept}$$

## **Simple linear regression**

$$\Large{\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 X}$$

## How do we choose values for $\hat{\beta}_1$ and $\hat{\beta}_0$?

```{r}
ggplot(data = movie_scores, 
       mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.4) + 
  geom_abline(intercept = 32.296, slope = 0.5187, color = "red", size = 1) +
  geom_abline(intercept = 25, slope = 0.7, color = "steel blue") +
  geom_abline(intercept = 21, slope = 0.9, color = "steel blue") +
  geom_abline(intercept = 35, slope = 0.3, color = "steel blue") +
  labs(x = "Critics Score", y = "Audience Score") +
  theme_minimal()
```

## Residuals

```{r}
#| warning: false
#| message: false
ggplot(data = movie_scores, mapping = aes(x = critics, y = audience)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  geom_segment(aes(x = critics, xend = critics, y = audience, yend = predict(m)), color = "steel blue") +
  labs(x = "Critics Score", y = "Audience Score") +
  theme_minimal() +
  theme(legend.position = "none")
```

$$\text{residual} = \text{observed} - \text{predicted} = y - \hat{y}$$

## Least squares line

-   The residual for the $i^{th}$ observation is

$$e_i = \text{observed} - \text{predicted} = y_i - \hat{y}_i$$

-   The **sum of squared** residuals is

$$e^2_1 + e^2_2 + \dots + e^2_n$$

-   The **least squares line** is the one that minimizes the sum of squared residuals

```{r}
sx <- round(sqrt(var(movie_scores$critics)), 4)
sy <- round(sqrt(var(movie_scores$audience)), 4)
r <- round(cor(movie_scores$critics, movie_scores$audience), 4)
xbar <- round(mean(movie_scores$critics), 4)
ybar <- round(mean(movie_scores$audience), 4)
```

## Estimating the slope

$$\large{\hat{\beta}_1 = r \frac{s_Y}{s_X}}$$

::: columns
::: {.column width="50%"}
$$
\begin{aligned} 
s_X &= 30.169 \\
s_Y &=  20.024 \\
r &= 0.781
\end{aligned}
$$
:::

::: {.column width="50%"}
$$
\begin{aligned}
\hat{\beta}_1 &= 0.781 \times \frac{20.024}{30.169} \\
&= 0.518\end{aligned}
$$
:::
:::

## Estimating the intercept

$$\large{\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X}}$$

::: columns
::: {.column width="50%"}
$$\begin{aligned}
&\bar{x} = 60.850 \\
&\bar{y} = 63.877 \\
&\hat{\beta}_1 = 0.518 
\end{aligned}$$
:::

::: {.column width="50%"}
$$
\begin{aligned}\hat{\beta}_0 &= 63.877 - 0.518 \times 60.850 \\
&= 32.296
\end{aligned}
$$
:::
:::

## Interpreting slope & intercept $$\widehat{\text{audience}} = 32.296 + 0.518 \times \text{critics}$$

-   **Slope:** For every one point increase in the critics score, we expect the audience score to increase by 0.518 points, on average.
-   **Intercept:** If the critics score is 0 points, we expect the audience score to be 32.296 points.

## Does it make sense to interpret the intercept?

âœ… Interpret the intercept if - the predictor can feasibly take values equal to or near zero.
- there are values near zero in the data.

ðŸ›‘ Otherwise, don't interpret the intercept!

## Recap

-   Used simple linear regression to describe the relationship between a quantitative predictor and quantitative response variable.
-   Used the least squares method to estimate the slope and intercept.
-   We interpreted the slope and intercept.
    -   **Slope:** For every one unit increase in $x$, we expect y to change by $\hat{\beta}_1$ units, on average.
    -   **Intercept:** If $x$ is 0, then we expect $y$ to be $\hat{\beta}_0$ units.
